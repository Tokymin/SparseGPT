运行原版 SparseGPT (固定4.0bit量化)...
/media/user/data3/toky/CondaEnvs/SparseGPT/lib/python3.10/site-packages/huggingface_hub/file_download.py:945: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Reusing dataset ptb_text_only (/home/user/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f)
Reusing dataset ptb_text_only (/home/user/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f)
Starting ...
Ready.
0 self_attn.k_proj
Pruning ...
time 0.23
error 60483.7578125
0 self_attn.v_proj
Pruning ...
time 0.15
error 1842.25244140625
0 self_attn.q_proj
Pruning ...
time 0.15
error 59382.625
0 self_attn.out_proj
Pruning ...
time 0.15
error 26.375904083251953
0 fc1
Pruning ...
time 0.15
error 7670.39013671875
0 fc2
Pruning ...
time 0.62
error 134.61297607421875
1 self_attn.k_proj
Pruning ...
time 0.15
error 45620.3671875
1 self_attn.v_proj
Pruning ...
time 0.15
error 2204.57421875
1 self_attn.q_proj
Pruning ...
time 0.16
error 21390.19921875
1 self_attn.out_proj
Pruning ...
time 0.15
error 18.985633850097656
1 fc1
Pruning ...
time 0.15
error 25562.3828125
1 fc2
Pruning ...
time 0.68
error 66.792724609375
2 self_attn.k_proj
Pruning ...
time 0.15
error 72915.453125
2 self_attn.v_proj
Pruning ...
time 0.15
error 5610.47119140625
2 self_attn.q_proj
Pruning ...
time 0.15
error 64397.734375
2 self_attn.out_proj
Pruning ...
time 0.15
error 30.194114685058594
2 fc1
Pruning ...
time 0.15
error 23504.01171875
2 fc2
Pruning ...
time 0.62
error 65.62787628173828
3 self_attn.k_proj
Pruning ...
time 0.16
error 64163.03125
3 self_attn.v_proj
Pruning ...
time 0.15
error 7288.86572265625
3 self_attn.q_proj
Pruning ...
time 0.15
error 61018.0859375
3 self_attn.out_proj
Pruning ...
time 0.15
error 32.43622589111328
3 fc1
Pruning ...
time 0.15
error 24957.265625
3 fc2
Pruning ...
time 0.62
error 27.586196899414062
4 self_attn.k_proj
Pruning ...
time 0.16
error 95771.203125
4 self_attn.v_proj
Pruning ...
time 0.16
error 9405.625
4 self_attn.q_proj
Pruning ...
time 0.15
error 101546.78125
4 self_attn.out_proj
Pruning ...
time 0.15
error 71.92254638671875
4 fc1
Pruning ...
time 0.15
error 27980.083984375
4 fc2
Pruning ...
time 0.62
error 130.1239013671875
5 self_attn.k_proj
Pruning ...
time 0.16
error 100708.34375
5 self_attn.v_proj
Pruning ...
time 0.15
error 8345.783203125
5 self_attn.q_proj
Pruning ...
time 0.15
error 114260.3125
5 self_attn.out_proj
Pruning ...
time 0.15
error 125.51058197021484
5 fc1
Pruning ...
time 0.15
error 24425.421875
5 fc2
Pruning ...
time 0.63
error 238.82765197753906
6 self_attn.k_proj
Pruning ...
time 0.15
error 104159.703125
6 self_attn.v_proj
Pruning ...
time 0.16
error 10972.0947265625
6 self_attn.q_proj
Pruning ...
time 0.15
error 108480.03125
6 self_attn.out_proj
Pruning ...
time 0.15
error 140.72988891601562
6 fc1
Pruning ...
time 0.15
error 22967.75
6 fc2
Pruning ...
time 0.62
error 272.2501220703125
7 self_attn.k_proj
Pruning ...
time 0.16
error 117863.4296875
7 self_attn.v_proj
Pruning ...
time 0.15
error 12066.771484375
7 self_attn.q_proj
Pruning ...
time 0.15
error 117523.9609375
7 self_attn.out_proj
Pruning ...
time 0.15
error 215.04440307617188
7 fc1
Pruning ...
time 0.15
error 27684.37109375
7 fc2
Pruning ...
time 0.62
error 258.77178955078125
8 self_attn.k_proj
Pruning ...
time 0.16
error 112939.78125
8 self_attn.v_proj
Pruning ...
time 0.15
error 16476.521484375
8 self_attn.q_proj
Pruning ...
time 0.15
error 126095.4453125
8 self_attn.out_proj
Pruning ...
time 0.15
error 429.03192138671875
8 fc1
Pruning ...
time 0.15
error 36655.6953125
8 fc2
Pruning ...
time 0.62
error 383.44122314453125
9 self_attn.k_proj
Pruning ...
time 0.16
error 125828.234375
9 self_attn.v_proj
Pruning ...
time 0.15
error 19010.720703125
9 self_attn.q_proj
Pruning ...
time 0.15
error 137284.5
9 self_attn.out_proj
Pruning ...
time 0.15
error 1039.29248046875
9 fc1
Pruning ...
time 0.15
error 49782.5078125
9 fc2
Pruning ...
time 0.62
error 541.6715698242188
10 self_attn.k_proj
Pruning ...
time 0.15
error 116844.0
10 self_attn.v_proj
Pruning ...
time 0.15
error 23404.00390625
10 self_attn.q_proj
Pruning ...
time 0.15
error 117264.7734375
10 self_attn.out_proj
Pruning ...
time 0.15
error 564.8628540039062
10 fc1
Pruning ...
time 0.15
error 61997.52734375
10 fc2
Pruning ...
time 0.62
error 839.4380493164062
11 self_attn.k_proj
Pruning ...
time 0.16
error 110836.390625
11 self_attn.v_proj
Pruning ...
time 0.16
error 28375.43359375
11 self_attn.q_proj
Pruning ...
time 0.16
error 120553.671875
11 self_attn.out_proj
Pruning ...
time 0.16
error 2099.109130859375
11 fc1
Pruning ...
time 0.15
error 61467.71484375
11 fc2
Pruning ...
time 0.62
error 1081.318603515625
model.decoder.embed_tokens.weight tensor(3.8851e-07)
model.decoder.embed_positions.weight tensor(0.0005)
model.decoder.final_layer_norm.weight tensor(0.)
model.decoder.final_layer_norm.bias tensor(0.)
model.decoder.layers.0.self_attn.k_proj.weight tensor(0.7003)
model.decoder.layers.0.self_attn.k_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.v_proj.weight tensor(0.7003)
model.decoder.layers.0.self_attn.v_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.q_proj.weight tensor(0.7002)
model.decoder.layers.0.self_attn.q_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.out_proj.weight tensor(0.7040)
model.decoder.layers.0.self_attn.out_proj.bias tensor(0.)
model.decoder.layers.0.self_attn_layer_norm.weight tensor(0.)
model.decoder.layers.0.self_attn_layer_norm.bias tensor(0.)
model.decoder.layers.0.fc1.weight tensor(0.7003)
model.decoder.layers.0.fc1.bias tensor(0.)
model.decoder.layers.0.fc2.weight tensor(0.7029)
23.875426530838013
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 281.376007
ptb
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 364.770599
c4
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 202.244797
完成时间: 2025年 10月 12日 星期日 23:24:30 CST

