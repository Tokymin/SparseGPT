运行原版 SparseGPT (固定3.0bit量化)...
/media/user/data3/toky/CondaEnvs/SparseGPT/lib/python3.10/site-packages/huggingface_hub/file_download.py:945: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Reusing dataset ptb_text_only (/home/user/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f)
Reusing dataset ptb_text_only (/home/user/.cache/huggingface/datasets/ptb_text_only/penn_treebank/1.1.0/8d1b97746fb9765d140e569ec5ddd35e20af4d37761f5e1bf357ea0b081f2c1f)
Starting ...
Ready.
0 self_attn.k_proj
Pruning ...
time 0.23
error 57250.984375
0 self_attn.v_proj
Pruning ...
time 0.15
error 1092.53662109375
0 self_attn.q_proj
Pruning ...
time 0.15
error 47736.3359375
0 self_attn.out_proj
Pruning ...
time 0.15
error 21.1658992767334
0 fc1
Pruning ...
time 0.16
error 3793.179931640625
0 fc2
Pruning ...
time 0.62
error 153.92967224121094
1 self_attn.k_proj
Pruning ...
time 0.15
error 35631.93359375
1 self_attn.v_proj
Pruning ...
time 0.16
error 1217.8955078125
1 self_attn.q_proj
Pruning ...
time 0.15
error 24141.7421875
1 self_attn.out_proj
Pruning ...
time 0.15
error 21.551101684570312
1 fc1
Pruning ...
time 0.15
error 16504.19921875
1 fc2
Pruning ...
time 0.62
error 126.61308288574219
2 self_attn.k_proj
Pruning ...
time 0.15
error 83321.90625
2 self_attn.v_proj
Pruning ...
time 0.15
error 3216.19580078125
2 self_attn.q_proj
Pruning ...
time 0.15
error 67450.359375
2 self_attn.out_proj
Pruning ...
time 0.16
error 28.293807983398438
2 fc1
Pruning ...
time 0.15
error 15874.0810546875
2 fc2
Pruning ...
time 0.62
error 120.55571746826172
3 self_attn.k_proj
Pruning ...
time 0.16
error 52572.43359375
3 self_attn.v_proj
Pruning ...
time 0.15
error 4415.3154296875
3 self_attn.q_proj
Pruning ...
time 0.16
error 49863.6484375
3 self_attn.out_proj
Pruning ...
time 0.15
error 31.707345962524414
3 fc1
Pruning ...
time 0.15
error 9855.814453125
3 fc2
Pruning ...
time 0.62
error 88.76116943359375
4 self_attn.k_proj
Pruning ...
time 0.16
error 71615.3125
4 self_attn.v_proj
Pruning ...
time 0.15
error 5604.41796875
4 self_attn.q_proj
Pruning ...
time 0.15
error 68912.5625
4 self_attn.out_proj
Pruning ...
time 0.15
error 51.152103424072266
4 fc1
Pruning ...
time 0.15
error 16757.22265625
4 fc2
Pruning ...
time 0.63
error 251.369384765625
5 self_attn.k_proj
Pruning ...
time 0.16
error 80111.453125
5 self_attn.v_proj
Pruning ...
time 0.15
error 4973.173828125
5 self_attn.q_proj
Pruning ...
time 0.16
error 79499.7578125
5 self_attn.out_proj
Pruning ...
time 0.15
error 72.43318176269531
5 fc1
Pruning ...
time 0.16
error 15328.2900390625
5 fc2
Pruning ...
time 0.62
error 455.14434814453125
6 self_attn.k_proj
Pruning ...
time 0.16
error 86205.9375
6 self_attn.v_proj
Pruning ...
time 0.15
error 6776.96826171875
6 self_attn.q_proj
Pruning ...
time 0.15
error 76624.625
6 self_attn.out_proj
Pruning ...
time 0.15
error 101.77206420898438
6 fc1
Pruning ...
time 0.15
error 15012.95703125
6 fc2
Pruning ...
time 0.61
error 596.6390380859375
7 self_attn.k_proj
Pruning ...
time 0.16
error 94709.9375
7 self_attn.v_proj
Pruning ...
time 0.16
error 7739.7197265625
7 self_attn.q_proj
Pruning ...
time 0.15
error 86269.171875
7 self_attn.out_proj
Pruning ...
time 0.15
error 171.33642578125
7 fc1
Pruning ...
time 0.15
error 18224.373046875
7 fc2
Pruning ...
time 0.61
error 765.0911865234375
8 self_attn.k_proj
Pruning ...
time 0.16
error 97161.9140625
8 self_attn.v_proj
Pruning ...
time 0.15
error 11092.1865234375
8 self_attn.q_proj
Pruning ...
time 0.15
error 93659.84375
8 self_attn.out_proj
Pruning ...
time 0.15
error 248.73788452148438
8 fc1
Pruning ...
time 0.15
error 23417.8359375
8 fc2
Pruning ...
time 0.62
error 1134.7801513671875
9 self_attn.k_proj
Pruning ...
time 0.16
error 102728.5625
9 self_attn.v_proj
Pruning ...
time 0.16
error 12535.40234375
9 self_attn.q_proj
Pruning ...
time 0.15
error 94269.859375
9 self_attn.out_proj
Pruning ...
time 0.15
error 440.8955993652344
9 fc1
Pruning ...
time 0.15
error 30274.357421875
9 fc2
Pruning ...
time 0.62
error 1503.572021484375
10 self_attn.k_proj
Pruning ...
time 0.15
error 112379.109375
10 self_attn.v_proj
Pruning ...
time 0.15
error 15559.7255859375
10 self_attn.q_proj
Pruning ...
time 0.15
error 90201.2734375
10 self_attn.out_proj
Pruning ...
time 0.15
error 422.62152099609375
10 fc1
Pruning ...
time 0.15
error 37630.19140625
10 fc2
Pruning ...
time 0.62
error 2404.2080078125
11 self_attn.k_proj
Pruning ...
time 0.15
error 98133.171875
11 self_attn.v_proj
Pruning ...
time 0.16
error 20126.068359375
11 self_attn.q_proj
Pruning ...
time 0.15
error 85547.2421875
11 self_attn.out_proj
Pruning ...
time 0.15
error 854.8323364257812
11 fc1
Pruning ...
time 0.15
error 50527.9453125
11 fc2
Pruning ...
time 0.62
error 3182.43310546875
model.decoder.embed_tokens.weight tensor(3.8851e-07)
model.decoder.embed_positions.weight tensor(0.0005)
model.decoder.final_layer_norm.weight tensor(0.)
model.decoder.final_layer_norm.bias tensor(0.)
model.decoder.layers.0.self_attn.k_proj.weight tensor(0.5994)
model.decoder.layers.0.self_attn.k_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.v_proj.weight tensor(0.5226)
model.decoder.layers.0.self_attn.v_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.q_proj.weight tensor(0.5591)
model.decoder.layers.0.self_attn.q_proj.bias tensor(0.)
model.decoder.layers.0.self_attn.out_proj.weight tensor(0.5424)
model.decoder.layers.0.self_attn.out_proj.bias tensor(0.)
model.decoder.layers.0.self_attn_layer_norm.weight tensor(0.)
model.decoder.layers.0.self_attn_layer_norm.bias tensor(0.)
model.decoder.layers.0.fc1.weight tensor(0.5058)
model.decoder.layers.0.fc1.bias tensor(0.)
model.decoder.layers.0.fc2.weight tensor(0.5836)
23.858710527420044
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 62.876881
ptb
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 95.251015
c4
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
Perplexity: 53.256535
完成时间: 2025年 10月 12日 星期日 23:03:05 CST

